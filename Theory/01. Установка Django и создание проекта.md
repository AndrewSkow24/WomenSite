# Установка Django и создание проекта 

## 1. Django, что это такое ? Инструментальные средства

Именно Django завоевал огромную популярность благодаря 
простоте разработки даже очень сложных сайтов, например таких, как 
youtube, google, dropbox, instagram. 

Все они сделаны с использованием фреймворка Django. И давайте теперь 
разберёмся, для чего он вообще нужен. Если очень кратко, то для 
обеспечения работы сайтов на стороне сервера. То есть это инструмент для 
бэкенд-разработчиков. А если немного подробнее, то процесс взаимодействия 
пользователя с сайтом можно представить следующим образом. 

1. Сначала от клиента поступает запрос, например, он вводит в браузере
адрес https://youtube.com. 
2. Информационные пакеты начинают двигаться в сторону сервера с сайтом 
Youtube. Вопрос о том, как именно они это делают, мы оставим в стороне, 
это называется маршрутизацией в сети интернет. Главное, что они доходят 
до сервера (то есть компьютера), где расположен Youtube. 
3. На этом компьютере установлено специальное программное обеспечение - 
Web-сервер. Очень часто используются уже готовые разработки с открытым 
исходным кодом: Apache, Nginx. Реже какие-либо свои программные продукты.
4. Так вот, этот Web-сервер "слушает" каналы связи и в момент поступления 
запроса от пользователя должен перенаправить его на обработку 
соответствующему сайту (так как на одном сервере может находиться 
множество сайтов).
5. Сайты, способны по-разному обрабатывать входящие запросы, например, 
используя PHP и CGI скрипты, или же могут использовать фреймворки, 
значительно упрощающие обработку запросов от клиентов сайта. 
6. В частности Django - это и есть такой фреймворк, значительно упрощающий
написание скриптов на языке Python. А взаимодействие с сервером происходит
по интерфейсу WSGI, который предаёт запросы в Django. 
7. При этом отрабатывает определённое представление, отвечающее за
определённый запрос, отвечающее за текущий запрос, и результатом обработки, 
как правило, является HTML-страница, которая сначала передаётся 
Web-серверу также по WSGI-интерфейсу, а он уже передает страницу конечному
пользователю.
8. Страница отображается в браузере клиента и он видит заветный сайт 
Youtube. Вот так в очень упрощённом виде происходит взаимодействие 
между пользователем, сервером и фреймворком. 

**WSGI (Web Server Gateway Interface)** - стандарт взаимодействия с 
между Python-программой, выполняющейся на стороне сервера, и самим 
веб-сервером. 

Отлично, теперь мы знаем, где находится фреймворк и за что он отвечает.
Но как нам в домашних условиях в учебных и целях разработки проекта запустить 
Django. Здесь есть хорошая новость.

Во-первых, во всех современных компьютерах 
функционирует внутренняя сеть, которая называется: `localhost - 127.0.0,1`.

Во-вторых, пакет Django в своём составе содержит отладочный веб-сервер, 
который можно запустить на домашнем ПК и проверить работу сайта, не 
используя сторонний сервер. Конечно, после полной разработки и отладки 
проекта сайта почти всегда размещаются на арендуемых серверах (хостингах)
и уже там работают в боевоем режими. 

### Что нужно знать для изучения фреймворка Django 

Если вы хотите во всех подробностях понимать работу фреймворка Django, то 
необходим следующий багаж знаний: 

- язык Python (в том числе и его ООП)
- работа с шаблонами (например, пакер Jinja)
- базовые знания работы с SQL-запросами 



## 2. Установка Django. Создание проекта

Версия интерпретатора
```bash
python3 -V
```
Список установленных пакетов
```bash
pip list
```

Установка виртуального окружения
```bash
python3 -m venv venv
```

Активация
```bash
source venv/bin/activate
```

Деактивация
```bash
source venv/bin/deactivate
```

Установка Django
```bash
pip install django
```

Список команд
```bash
django-admin
```

Available subcommands:

[django]
    check
    compilemessages
    createcachetable
    dbshell
    diffsettings
    dumpdata
    flush
    inspectdb
    loaddata
    makemessages
    makemigrations
    migrate
    optimizemigration
    runserver
    sendtestemail
    shell
    showmigrations
    sqlflush
    sqlmigrate
    sqlsequencereset
    squashmigrations
    startapp
    startproject
    test
    testserver

Создание проекта
```bash
django-admin startproject sitewomen 
```

Запуск сервера
```bash
python3 manage.py runserver
```


Запуск сервера на порту 4000
```bash
python3 manage.py runserver 4000
```

## 3. Модель MTV создание первого приложения

Подробнее о том, как в Django работает механизм 
обработки запросов от пользователя. 

Когда запрос приходит на фреймворк, он пропускается через блоки
маршрутизации. Здесь фиксируется тип URL-адреса и в списке шаблонов 
предопределённых адресов ищется первое совпадение. 

- https://127.0.0.1/category/1/ соответствует шаблону `category/<число>`
- https://127.0.0.1/women/madonna/ соответствует шаблону `category/<слаг (строка)>`

У нас может быть прописано множество типов URL-адресов и каждый шаблон 
связан со своим обработчиком - представлением (иногда его ещё называют контроллером).

Если текущий запрос от пользователя не совпал ни с одним предопределённым 
URL, то возвращается код ошибки 404 - страница не найдена. 

Предположим, что маршрутизатор нашёл совпадение. Далее активизируется 
представление, связанное с найденными типом URL-адреса. Представление - 
это функция или класс, которые отвечают за формирование ответа на
соответствующий запрос. Как правило, ответом является HTML-страница.
Эта страница, затем возвращается клиенту, и он увидит в браузере. 

Чтобы представление могло сформировать страницу в общем случае потребуются 
данные (информация), шаблоны, в которые эти данные упаковываются. 

Например, приходит запрос на вывод информации о Мадонне: 

https://127.0.0.1/women/madonna/ 

Срабатывает соответствующее представление, которое берёт шаблон информационной 
страницы и наполняет данные об этой певице. Данные хранятся в базе данных. 

На выходе получаем сформированную HTML-страницу, которая и возвращается 
пользователю. 

Вот такое разделение на:
- данные (model) 
- шаблоны (templates)
- представления (views)
представляет собой общеизвестный паттерн MTV, то есть разделение данных 
и HTML-шаблонов

### Добавление первого приложения 

Разработчики фреймворка решили, что каждая самостоятельная часть сайта 
должна представляться в виде своего отдельного приложения. 

Например, создавая, информационный сайт, мы должны будем определить 
приложение для отображения страниц этого сайта по определённым запросам.

Форум, например, независимая часть сайта, поэтому для него будет отдельное 
приложение. 

Опрос - отдельное приложение. 

Каждая логически функционально независимая часть сайта предполагает 
реализацию в виде отдельного приложения. 

Приложение в Django сделдует реализовывать максимально независимыми, 
в идеале полностью независимыми, чтобы в дальнейшем мы могли их просто скопировать 
на другой сайта, и они начали сразу работать. Это не всегда удаётся, но к этому нужно стремиться. 

Создаём наше первое приложение, которое возьмёт на себя базовый функционал, 
то есть оно будет являться ядром сайта. 

Команда для создания приложения
```bash
python3 manage.py startapp women
```

Файл `__init__.py` говорит о том, что приложение 
в Django реализуется как пакет языка Python. 

Присутствует одна вложенная папка `migrations` для хранения миграций БД. 

Остальные файлы: 

- **admin.py** - для настройки админ-панели 
- **apps.py** - для настройки текущего приложения
- **models.py** - для хранения ORM-моделей для представления данных из базы данных
- **tests.py** - модель с тестирующими процедурами
- **views.py** - для хранения представления (контроллеров) текущего приложения 

После создания приложения его необходимо зарегистрировать в проекте нашего сайта, 
чтобы фреймворк знал о его существовании и корректно с ним работал. 

В файле `settings.py` в пакете конфигурации сайта необходимо в список 
добавить приложение woman. 



## 4. Маршрутизация и функции представления

## 5. Отладка проекта в Django в Pycharm

## 6. Динамические URL. Пользовательские конверторы

## 7. GET- и -POST-запросы. Обработка исключений запросов

## 8. Перенаправление (redirect). Функция reverse 